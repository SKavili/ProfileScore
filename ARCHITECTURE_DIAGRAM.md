# ProfileScore Architecture Diagram

## System Overview

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           ProfileScore System Architecture                                    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           EXTERNAL INTERFACES                                                │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   HTTP Clients  │    │  FastAPI Docs   │    │  ReDoc Docs     │    │  Health Checks  │
│   (REST API)    │    │   (/docs)       │    │   (/redoc)      │    │   (/health)     │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │                       │
         └───────────────────────┼───────────────────────┼───────────────────────┘
                                 │                       │
                                 ▼                       ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           FASTAPI APPLICATION LAYER                                          │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  FastAPI App (main.py)                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Application Lifecycle Manager (lifespan)                                                               │ │
│  │  • Startup: Load models, initialize services, validate config                                           │ │
│  │  • Shutdown: Cleanup resources, unload models                                                           │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  API Endpoints                                                                                          │ │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │ │
│  │  │   /score    │ │/score/enh.. │ │/candidates  │ │   /jobs     │ │/candidates/ │ │/scoring/    │        │ │
│  │  │             │ │             │ │             │ │             │ │   search    │ │  history    │        │ │
│  │  │ Basic       │ │ Enhanced    │ │ CRUD        │ │ CRUD        │ │ Vector      │ │ Historical  │        │ │
│  │  │ Scoring     │ │ Scoring     │ │ Operations  │ │ Operations  │ │ Search      │ │ Results     │        │ │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘        │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           SERVICE LAYER                                                     │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Core Services                                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  LLaMA Service (llama_service.py)                                                                       │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Model Loading/Unloading                                                                          │ │ │
│  │  │  • Profile Scoring (0-100)                                                                          │ │ │
│  │  │  • Response Parsing & Validation                                                                    │ │ │
│  │  │  • Quantization Support (8-bit/16-bit)                                                              │ │ │
│  │  │  • GPU/CPU Fallback Handling                                                                        │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Pinecone Service (pinecone_service.py)                                                                 │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Vector Database Operations                                                                       │ │ │
│  │  │  • Candidate/Job Storage & Retrieval                                                                │ │ │
│  │  │  • Semantic Search & Matching                                                                       │ │ │
│  │  │  • Scoring History Storage                                                                          │ │ │
│  │  │  • Embedding Generation (SentenceTransformers)                                                      │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  LangChain Service (langchain_service.py)                                                               │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Enhanced AI Processing                                                                           │ │ │
│  │  │  • Skill Extraction & Analysis                                                                      │ │ │
│  │  │  • Profile Analysis & Insights                                                                      │ │ │
│  │  │  • Job Requirements Extraction                                                                      │ │ │
│  │  │  • Agent-based Search Tools                                                                         │ │ │
│  │  │  • Batch Processing Capabilities                                                                    │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           DATA LAYER                                                        │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Data Models (models.py)                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Request/Response Models                                                                                │ │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │ │
│  │  │ScoringRequest│ │ScoringResponse│ │CandidateData │ │  JobData    │ │CandidateSearch│ │HealthResponse│        │ │
│  │  │             │ │             │ │             │ │             │ │   Request   │ │             │        │ │
│  │  │ • Profile   │ │ • Score     │ │ • Profile   │ │ • Job       │ │ • Query     │ │ • Status    │        │ │
│  │  │ • Job Desc  │ │ • Explanation│ │ • Skills    │ │ • Requirements│ • Filters   │ │ • Timestamp │        │ │
│  │  │ • Metadata  │ │ • Confidence│ │ • Experience│ │ • Location  │ • Max Results│ │ • Services  │        │ │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘        │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           UTILITY LAYER                                                     │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Utilities                                                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Configuration (config.py)                                                                              │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Environment Variable Validation                                                                  │ │ │
│  │  │  • Configuration Summary                                                                            │ │ │
│  │  │  • Required vs Optional Settings                                                                    │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Logging (logger.py)                                                                                    │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Structured Logging                                                                               │ │ │
│  │  │  • Loguru Integration                                                                               │ │ │
│  │  │  • Log File Management                                                                               │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           EXTERNAL SERVICES                                                 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  External Dependencies                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Hugging Face Hub                                                                                       │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • LLaMA 2 Model Access (meta-llama/Llama-2-7b-chat-hf)                                            │ │ │
│  │  │  • Sentence Transformers (all-MiniLM-L6-v2)                                                        │ │ │
│  │  │  • Model Download & Caching                                                                         │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Pinecone Vector Database                                                                               │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Vector Storage & Retrieval                                                                       │ │ │
│  │  │  • Semantic Search                                                                                  │ │ │
│  │  │  • Index Management                                                                                 │ │ │
│  │  │  • Metadata Filtering                                                                               │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  LangChain Platform (Optional)                                                                          │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│  │  │  • Tracing & Monitoring                                                                             │ │ │
│  │  │  • Experiment Tracking                                                                              │ │ │
│  │  │  • Performance Analytics                                                                            │ │ │
│  │  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           DATA FLOW                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Request Flow                                                                                               │
│                                                                                                             │
│  1. Client Request → FastAPI Endpoint                                                                       │
│  2. Request Validation → Pydantic Models                                                                    │
│  3. Service Orchestration → LLaMA/Pinecone/LangChain                                                       │
│  4. Model Processing → LLaMA 2 Inference                                                                    │
│  5. Vector Operations → Pinecone Storage/Search                                                             │
│  6. Enhanced Processing → LangChain Analysis                                                                │
│  7. Response Assembly → Structured JSON Response                                                            │
│  8. Client Response ← FastAPI Response                                                                      │
│                                                                                                             │
│  Storage Flow                                                                                               │
│                                                                                                             │
│  1. Candidate/Job Data → Pinecone Service                                                                   │
│  2. Text Processing → Sentence Transformers                                                                 │
│  3. Vector Generation → 384-dimensional Embeddings                                                          │
│  4. Metadata Enrichment → Skills, Experience, Location                                                      │
│  5. Vector Storage → Pinecone Index                                                                         │
│  6. Search Indexing → Cosine Similarity Search                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                           DEPLOYMENT                                                        │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Application Startup                                                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │  1. Environment Validation                                                                              │ │
│  │  2. LLaMA 2 Model Loading (with quantization fallback)                                                 │ │
│  │  3. Pinecone Connection & Index Setup                                                                   │ │
│  │  4. LangChain Service Initialization                                                                    │ │
│  │  5. FastAPI Server Startup (Uvicorn)                                                                    │ │
│  │  6. Health Check Endpoints Available                                                                    │ │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

## Key Features

### 🔧 **Core Capabilities**
- **AI-Powered Scoring**: LLaMA 2-based profile matching (0-100 scores)
- **Vector Search**: Semantic candidate/job matching via Pinecone
- **Enhanced Analysis**: LangChain-powered skill extraction and insights
- **RESTful API**: Complete CRUD operations for candidates and jobs
- **Batch Processing**: Efficient bulk scoring operations

### 🏗️ **Architecture Benefits**
- **Modular Design**: Separated concerns with clear service boundaries
- **Scalable**: Vector database for efficient similarity search
- **Robust**: Comprehensive error handling and fallback mechanisms
- **Extensible**: Easy to add new models, services, or features
- **Production-Ready**: Health checks, logging, configuration management

### 🔒 **Security & Reliability**
- **Environment-based Configuration**: Secure credential management
- **Input Validation**: Pydantic models for request/response validation
- **Error Handling**: Graceful degradation and informative error messages
- **Resource Management**: Proper model loading/unloading lifecycle

### 📊 **Monitoring & Observability**
- **Structured Logging**: Comprehensive application logging
- **Health Checks**: Service status monitoring
- **Model Information**: Runtime model details and statistics
- **Performance Metrics**: Response times and throughput tracking 